import{L as e,O as a,M as s,y as t,u as l,d as c,w as o,i as r,o as n,e as u,f as d,E as i,q as f,h as p,z as h,C as v,c as m,P as g,a as w,n as _,N as y,k as b,j as k,Q as C}from"./index-BxQnvICo.js";import{_ as x}from"./uni-icons.CzdU9Ibo.js";import{r as T}from"./uni-app.es.yPB3nhiz.js";import{_ as E}from"./btc.JZb5stum.js";import{_ as A}from"./eth.BkoDDH_E.js";import{_ as F,a as R}from"./usdc.C8qnB_UY.js";import{b as U,a as S,s as j}from"./api.CcqH0Zgx.js";import{_ as W}from"./_plugin-vue_export-helper.BCo6x5W8.js";const L=W({__name:"index",setup(W){let L=0;const B=e("receive"),D=e("0.00"),V=e("0.00"),P=e("0.00"),I=e("usdt"),q=e(""),H=e(""),N=e({}),z=e("usdt"),M=e(""),O=e("");e("usdt");const Q=e(""),G=async()=>{try{U.showLoading("Loading account info...");const e=await S.user.getInfo();e&&(D.value=U.formatAmount(e.money),V.value=U.formatAmount(e.total_revenue),P.value=U.formatAmount(e.earnings_24h),console.log("Account information updated successfully:",{availableBalance:D.value,totalRevenue:V.value,earnings24h:P.value}))}catch(e){console.error("Failed to get user info:",e),U.showError("Failed to load account data")}finally{U.hideLoading()}},X=()=>{h({title:"Confirm",content:"Are you sure you want to return to the previous page? Unsaved data will be lost.",showCancel:!0,cancelText:"Cancel",confirmText:"Confirm",success:e=>{e.confirm&&v({delta:1,success:()=>{console.log("Successfully returned to the previous page")},fail:e=>{console.error("Return failed:",e),m({url:"/pages/index/index"})}})}})};a((()=>!Q.value||parseFloat(Q.value)<=0?"0.00":Q.value));const $=e=>{B.value=e,console.log("change tab:",e)},J=e=>{I.value=e,console.log("select currency:",e)},K=()=>{g({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{const a=e.tempFiles[0],s=new FileReader;s.onload=e=>{H.value=e.target.result,console.log("image converted to base64 successfully")},s.onerror=e=>{console.error("image conversion to base64 failed:",e),w({title:"image processing failed",icon:"none"})},s.readAsDataURL(a)},fail:e=>{console.error("image selection failed:",e),w({title:"image selection failed",icon:"none"})}})},Y=async()=>{if(H.value)if(!q.value||parseFloat(q.value)<=0)U.showError("please enter a valid recharge amount");else try{U.showLoading("submitting...");if(!(j.getToken()||(w({title:"please connect wallet first",icon:"none"}),setTimeout((()=>{_({url:"/pages/wallet/connect"})}),1500),"")))return;console.log("=== image information debugging ==="),console.log("uploadedImage.value length:",H.value.length);const e=await S.transaction.recharge(I.value,q.value,"ERC20",H.value);console.log("recharge response:",e),0===e.code||!0===e.success?(U.showSuccess("recharge application submitted successfully"),q.value="",H.value="",await G()):U.showError(e.info||e.message||"recharge failed")}catch(e){console.error("=== recharge failed ==="),console.error("error information:",e),U.showError("network error, please try again later")}finally{U.hideLoading()}else U.showError("please upload transaction screenshot first")},Z=e=>{z.value={Bitcoin:"btc",btc:"btc",eth:"eth",usdt:"usdt",usdc:"usdc"}[e]||e,console.log("select send currency:",z.value)},ee=()=>{D.value&&"0.00"!==D.value?(O.value=D.value.replace(/,/g,""),console.log("Set max withdrawal amount:",O.value)):U.showError("No available balance")},ae=async()=>{if(!M.value.trim())return void U.showError("Please enter withdrawal address");if(!O.value||parseFloat(O.value)<=0)return void U.showError("Please enter a valid withdrawal amount");const e=parseFloat(D.value.replace(/,/g,""));if(parseFloat(O.value)>e)U.showError("Withdrawal amount exceeds available balance");else try{U.showLoading("Processing withdrawal..."),console.log("Withdrawal request:",{currency:z.value,address:M.value,amount:O.value});const e=await S.transaction.withdraw(z.value,O.value,M.value);if(console.log("Withdrawal response:",e),!e||0!==e.code&&!0!==e.success){let a="Withdrawal failed";e&&e.info?a=e.info:e&&e.message&&(a=e.message),U.showError(a)}else U.showSuccess("Withdrawal application submitted successfully"),M.value="",O.value="",await G()}catch(a){console.error("Withdrawal request failed:",a);let e="Network error, please try again later";a.message&&(e=a.message.includes("timeout")?"Request timeout, please try again":a.message.includes("network")?"Network connection failed":a.message),U.showError(e)}finally{U.hideLoading()}},se=()=>{console.log("go to transaction record page"),_({url:"/pages/record/index?source=account&type=transaction"})},te=()=>{console.log("go to revenue record page"),_({url:"/pages/record/index?source=account&type=revenue"})},le=async()=>{try{const e=await S.transaction.getRechargeAddress();e&&(N.value=e,console.log("Recharge addresses loaded:",e))}catch(e){console.error("Failed to get recharge addresses:",e),U.showError("Failed to load recharge addresses")}},ce=()=>{if(!N.value)return"Loading...";switch(I.value){case"Bitcoin":return N.value.Bitcoin||"Address not available";case"eth":return N.value.erc||"Address not available";case"usdt":return N.value.usdt||"Address not available";case"usdc":return N.value.usdc||"Address not available";default:return"Address not available"}},oe=()=>{const e=ce();"Loading..."!==e&&"Address not available"!==e?y({data:e,success:()=>{U.showSuccess("Address copied to clipboard")},fail:()=>{U.showError("Failed to copy address")}}):U.showError("Address not available")},re=e=>({btc:"/static/btc.jpg",eth:"/static/eth.jpg",usdt:"/static/usdt.jpg",usdc:"/static/usdc.jpg"}[e]||"/static/usdt.jpg"),ne=e=>({btc:"Bitcoin",eth:"ETH",usdt:"ERC20",usdc:"ERC20"}[e]||"ERC20"),ue=e=>{const a=ne(e);return{"network-button":!0,"bitcoin-network":"Bitcoin"===a,"eth-network":"ETH"===a,"erc20-network":"ERC20"===a}};return s((async()=>{try{const e=t();L=e.statusBarHeight||0}catch(e){console.error("get status bar height failed:",e)}await Promise.all([G(),le()])})),(e,a)=>{const s=T(l("uni-icons"),x),t=r,h=b,v=k,m=C;return n(),c(t,{class:"account-container"},{default:o((()=>[u(t,{class:"custom-header"},{default:o((()=>[u(t,{class:"back-button",onClick:X},{default:o((()=>[u(s,{type:"left",size:"20",color:"#ffffff"})])),_:1}),u(h,{class:"page-title"},{default:o((()=>[d("Withdraw")])),_:1})])),_:1}),u(t,{class:"gradient-bg"}),u(t,{class:"content-area"},{default:o((()=>[u(t,{class:"upper-box"},{default:o((()=>[u(t,{class:"top-nav"},{default:o((()=>[u(t,{class:"nav-item",onClick:se},{default:o((()=>[u(h,{class:"nav-text"},{default:o((()=>[d("Transaction Record")])),_:1}),u(h,{class:"nav-arrow"},{default:o((()=>[d(">")])),_:1})])),_:1}),u(t,{class:"nav-divider"},{default:o((()=>[d("|")])),_:1}),u(t,{class:"nav-item",onClick:te},{default:o((()=>[u(h,{class:"nav-text"},{default:o((()=>[d("Revenue Record")])),_:1}),u(h,{class:"nav-arrow"},{default:o((()=>[d(">")])),_:1})])),_:1})])),_:1}),u(t,{class:"balance-area"},{default:o((()=>[u(t,{class:"balance-info"},{default:o((()=>[u(h,{class:"balance-label"},{default:o((()=>[d("Available Balance(USDT)")])),_:1}),u(h,{class:"balance-amount"},{default:o((()=>[d("$"+i(D.value),1)])),_:1})])),_:1}),u(t,{class:"revenue-stats"},{default:o((()=>[u(t,{class:"stat-item"},{default:o((()=>[u(h,{class:"stat-label"},{default:o((()=>[d("Total revenue(USDT)")])),_:1}),u(h,{class:"stat-value"},{default:o((()=>[d(i(V.value),1)])),_:1})])),_:1}),u(t,{class:"stat-divider"},{default:o((()=>[d("|")])),_:1}),u(t,{class:"stat-item"},{default:o((()=>[u(h,{class:"stat-label"},{default:o((()=>[d("Earnings 24h(USDT)")])),_:1}),u(h,{class:"stat-value"},{default:o((()=>[d(i(P.value),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),u(t,{class:"operation-box"},{default:o((()=>[u(t,{class:"operation-tabs"},{default:o((()=>[u(t,{class:f(["tab-item",{active:"receive"===B.value}]),onClick:a[0]||(a[0]=e=>$("receive"))},{default:o((()=>[u(h,{class:"tab-text"},{default:o((()=>[d("RECEIVE")])),_:1})])),_:1},8,["class"]),u(t,{class:f(["tab-item",{active:"send"===B.value}]),onClick:a[1]||(a[1]=e=>$("send"))},{default:o((()=>[u(h,{class:"tab-text"},{default:o((()=>[d("SEND")])),_:1})])),_:1},8,["class"])])),_:1}),"receive"===B.value?(n(),c(t,{key:0,class:"tab-content"},{default:o((()=>[u(h,{class:"section-title"},{default:o((()=>[d("Currency Type")])),_:1}),u(t,{class:"currency-buttons"},{default:o((()=>[u(t,{class:f(["currency-item",{selected:"btc"===I.value}]),onClick:a[2]||(a[2]=e=>J("btc"))},{default:o((()=>[u(v,{class:"crypto-icon",src:E,mode:"aspectFit"})])),_:1},8,["class"]),u(t,{class:f(["currency-item",{selected:"eth"===I.value}]),onClick:a[3]||(a[3]=e=>J("eth"))},{default:o((()=>[u(v,{class:"crypto-icon",src:A,mode:"aspectFit"})])),_:1},8,["class"]),u(t,{class:f(["currency-item",{selected:"usdt"===I.value}]),onClick:a[4]||(a[4]=e=>J("usdt"))},{default:o((()=>[u(v,{class:"crypto-icon",src:F,mode:"aspectFit"})])),_:1},8,["class"]),u(t,{class:f(["currency-item",{selected:"usdc"===I.value}]),onClick:a[5]||(a[5]=e=>J("usdc"))},{default:o((()=>[u(v,{class:"crypto-icon",src:R,mode:"aspectFit"})])),_:1},8,["class"])])),_:1}),u(t,{class:"divider-line"}),u(t,{class:"recharge-section"},{default:o((()=>[u(t,{class:"recharge-header"},{default:o((()=>[u(v,{class:"crypto-icon-small",src:re(I.value),mode:"aspectFit"},null,8,["src"]),u(h,{class:"recharge-title"},{default:o((()=>[d(i(I.value.toUpperCase())+" recharge",1)])),_:1})])),_:1}),u(t,{class:f(["network-button",ue(I.value)])},{default:o((()=>[u(h,{class:"network-text"},{default:o((()=>[d(i(ne(I.value)),1)])),_:1})])),_:1},8,["class"]),u(t,{class:"address-section"},{default:o((()=>[u(h,{class:"address-label"},{default:o((()=>[d("Recharge Address")])),_:1}),u(t,{class:"address-display"},{default:o((()=>[u(h,{class:"address-text"},{default:o((()=>[d(i(ce()),1)])),_:1}),u(t,{class:"copy-button",onClick:oe},{default:o((()=>[u(h,{class:"copy-text"},{default:o((()=>[d("Copy")])),_:1})])),_:1})])),_:1})])),_:1}),u(t,{class:"upload-area",onClick:K},{default:o((()=>[u(s,{type:"camera",size:"40",color:"#999999"}),u(h,{class:"upload-text"},{default:o((()=>[d("Click to upload transfer screenshot")])),_:1}),H.value?(n(),c(v,{key:0,src:H.value,class:"uploaded-image"},null,8,["src"])):p("",!0)])),_:1}),u(h,{class:"amount-label"},{default:o((()=>[d("Recharge amount")])),_:1}),u(m,{class:"amount-input",modelValue:q.value,"onUpdate:modelValue":a[6]||(a[6]=e=>q.value=e),placeholder:"Please input amount",type:"number"},null,8,["modelValue"]),u(h,{class:"notice-text"},{default:o((()=>[d(" Please any check the withdrawal address. Withdrawal of funds system will be based on the user's personal submission of the address for review, the audit passed automatically sent to your designated address account. The platform is not responsible for recovering the loss if the withdrawal address is entered incorrectly due to personal reasons. Only one withdrawal is supported per day. The minimum withdrawal amount is 30 Tether (USDT). A fee of 3 Tether (USDT) is charged for each withdrawal. ")])),_:1}),u(t,{class:"withdraw-button",onClick:Y},{default:o((()=>[u(h,{class:"withdraw-button-text"},{default:o((()=>[d("SUBMIT RECHARGE")])),_:1})])),_:1})])),_:1})])),_:1})):p("",!0),"send"===B.value?(n(),c(t,{key:1,class:"tab-content"},{default:o((()=>[u(h,{class:"section-title"},{default:o((()=>[d("Currency Type")])),_:1}),u(t,{class:"currency-buttons"},{default:o((()=>[u(t,{class:f(["currency-item",{selected:"btc"===z.value}]),onClick:a[7]||(a[7]=e=>Z("btc"))},{default:o((()=>[u(v,{class:"crypto-icon",src:E,mode:"aspectFit"})])),_:1},8,["class"]),u(t,{class:f(["currency-item",{selected:"eth"===z.value}]),onClick:a[8]||(a[8]=e=>Z("eth"))},{default:o((()=>[u(v,{class:"crypto-icon",src:A,mode:"aspectFit"})])),_:1},8,["class"]),u(t,{class:f(["currency-item",{selected:"usdt"===z.value}]),onClick:a[9]||(a[9]=e=>Z("usdt"))},{default:o((()=>[u(v,{class:"crypto-icon",src:F,mode:"aspectFit"})])),_:1},8,["class"]),u(t,{class:f(["currency-item",{selected:"usdc"===z.value}]),onClick:a[10]||(a[10]=e=>Z("usdc"))},{default:o((()=>[u(v,{class:"crypto-icon",src:R,mode:"aspectFit"})])),_:1},8,["class"])])),_:1}),u(t,{class:"divider-line"}),u(t,{class:"send-section"},{default:o((()=>[u(t,{class:"send-header"},{default:o((()=>[u(v,{class:"crypto-icon-small",src:re(z.value),mode:"aspectFit"},null,8,["src"]),u(h,{class:"send-title"},{default:o((()=>[d(i(z.value.toUpperCase())+" withdrawal",1)])),_:1})])),_:1}),u(t,{class:f(["network-button",ue(z.value)])},{default:o((()=>[u(h,{class:"network-text"},{default:o((()=>[d(i(ne(z.value)),1)])),_:1})])),_:1},8,["class"]),u(h,{class:"input-label"},{default:o((()=>[d("Withdrawal address")])),_:1}),u(m,{class:"address-input",modelValue:M.value,"onUpdate:modelValue":a[11]||(a[11]=e=>M.value=e),placeholder:"Please input address",type:"text"},null,8,["modelValue"]),u(h,{class:"input-label"},{default:o((()=>[d("Quantity")])),_:1}),u(t,{class:"quantity-input-container"},{default:o((()=>[u(m,{class:"quantity-input",modelValue:O.value,"onUpdate:modelValue":a[12]||(a[12]=e=>O.value=e),placeholder:"0.00",type:"number"},null,8,["modelValue"]),u(t,{class:"max-button",onClick:ee},{default:o((()=>[u(h,{class:"max-text"},{default:o((()=>[d("MAX")])),_:1})])),_:1})])),_:1}),u(h,{class:"notice-text"},{default:o((()=>[d(" Please any check the withdrawal address. Withdrawal of funds system will be based on the user's personal submission of the address for review, the audit passed automatically sent to your designated address account. The platform is not responsible for recovering the loss if the withdrawal address is entered incorrectly due to personal reasons. Only one withdrawal is supported per day. The minimum withdrawal amount is 30 Tether (USDT). A fee of 3 Tether (USDT) is charged for each withdrawal. ")])),_:1}),u(t,{class:"withdraw-button",onClick:ae},{default:o((()=>[u(h,{class:"withdraw-button-text"},{default:o((()=>[d("SUBMIT WITHDRAW")])),_:1})])),_:1})])),_:1})])),_:1})):p("",!0)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-a6e0808c"]]);export{L as default};
