import{C as e,b as a,d as t,w as s,i as r,o,e as l,f as i,E as d,F as c,G as n,H as u,k as f,q as m,j as g}from"./index-BxQnvICo.js";import{b as _,s as p,a as h}from"./api.CcqH0Zgx.js";import{_ as y,a as w,b as T,c as k}from"./icon14.BrQA54VK.js";import{_ as b}from"./btc.JZb5stum.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const R=v({data:()=>({orderList:[],loading:!1,error:null,source:"",recordType:"transaction"}),onLoad(e){this.source=e.source||"pledge",this.recordType=e.type||"transaction",console.log("Page loaded with source:",this.source,"type:",this.recordType),this.fetchOrderList()},methods:{goBack(){e({delta:1})},getPageTitle(){return"account"===this.source?"revenue"===this.recordType?"Revenue Record":"Transaction Record":"Order List"},async fetchOrderList(){this.loading=!0,this.error=null;try{_.showLoading("Loading...");const e=p.getToken();if(console.log("Current token:",e),!e)throw new Error("Authorization token not found, please reconnect wallet");let a;if(console.log("Sending order list request, token:",e,"source:",this.source,"type:",this.recordType),a="account"===this.source?"revenue"===this.recordType?await h.record.getRevenueRecord("4080000"):await h.record.getCashRecord():await h.record.getPledgeOrderList(),console.log("Order list response:",a),1===a.code){if(a.info&&a.info.includes("token"))throw console.log("Token validation failed, clearing token"),p.clearToken(),new Error("Session expired, please reconnect wallet");throw new Error(a.info||"Request failed")}let t=[];"account"===this.source?"revenue"===this.recordType?a&&a.zhiya&&Array.isArray(a.zhiya)&&(t=a.zhiya.map((e=>this.mapRevenueRecordData(e)))):a&&a.zhiya&&Array.isArray(a.zhiya)&&(t=a.zhiya.map((e=>this.mapCashRecordData(e)))):a&&a.data&&Array.isArray(a.data)&&(t=a.data),this.orderList=t,console.log("Order list loaded successfully, count:",this.orderList.length)}catch(e){console.error("Failed to get order list:",e),this.error=e.message||"Network request failed",e.message.includes("token")||e.message.includes("Session")?(_.showError("Please reconnect wallet"),setTimeout((()=>{a({url:"/pages/wallet/connect"})}),2e3)):_.showError(this.error)}finally{this.loading=!1,_.hideLoading()}},mapCashRecordData(e){return{id:e.id,type:e.type||"3",title:e.info||"Cash Record",amount:e.amount,bilv:e.bilv||"0",addtime:e.addtime,endtime:e.addtime,order_id:e.id,status:this.getCashRecordStatus(e),address:e.address,min_amount:e.min_amount,uid:e.uid,info:e.info}},mapRevenueRecordData(e){return{id:e.id||e.uid||Math.random().toString(),type:e.type||"5",title:e.info||"Revenue Record",amount:e.amount,bilv:e.bilv||"0",addtime:e.addtime,endtime:e.addtime,order_id:e.id||e.uid,status:this.getRevenueRecordStatus(e),address:e.address,min_amount:e.min_amount,uid:e.uid,info:e.info}},getRevenueRecordStatus:e=>"Profit"===e.info||"利润"===e.info||"推荐收益"===e.info?"1":"0",getCashRecordStatus:e=>"Recharge"===e.info||"充值"===e.info?"1":"0",formatAmount:e=>e?parseFloat(e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",formatTime(e){if(!e)return"";return new Date(1e3*parseInt(e)).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})},getOrderTypeTag:e=>({1:"LP",2:"ST",3:"TF",4:"AMM"}[e]||"TF"),getStatusText:e=>({0:"in progress",1:"completed",2:"expired",3:"cancelled"}[e]||"unknown"),getStatusClass:e=>({0:"in-progress",1:"completed",2:"expired",3:"cancelled"}[e]||"in-progress"),formatPercentage(e){if(!e)return"0";const a=e.toString().replace(/%$/,""),t=parseFloat(a);return Number.isInteger(t)||t%1==0?t.toString():t.toString().replace(/\.?0+$/,"")}}},[["render",function(e,a,_,p,h,v){const R=f,S=r,L=g;return o(),t(S,{class:"order-list-container"},{default:s((()=>[l(S,{class:"header"},{default:s((()=>[l(S,{class:"back-button",onClick:v.goBack},{default:s((()=>[l(R,{class:"back-icon"},{default:s((()=>[i("←")])),_:1})])),_:1},8,["onClick"]),l(R,{class:"page-title"},{default:s((()=>[i(d(v.getPageTitle()),1)])),_:1})])),_:1}),h.loading?(o(),t(S,{key:0,class:"loading-container"},{default:s((()=>[l(R,{class:"loading-text"},{default:s((()=>[i("Loading...")])),_:1})])),_:1})):h.error?(o(),t(S,{key:1,class:"error-container"},{default:s((()=>[l(R,{class:"error-text"},{default:s((()=>[i(d(h.error),1)])),_:1}),l(S,{class:"retry-button",onClick:v.fetchOrderList},{default:s((()=>[l(R,null,{default:s((()=>[i("Retry")])),_:1})])),_:1},8,["onClick"])])),_:1})):(o(),t(S,{key:2},{default:s((()=>[0===h.orderList.length?(o(),t(S,{key:0,class:"empty-container"},{default:s((()=>[l(R,{class:"empty-text"},{default:s((()=>[i("No order records")])),_:1})])),_:1})):(o(!0),c(u,{key:1},n(h.orderList,(e=>(o(),t(S,{class:"order-card",key:e.id},{default:s((()=>["account"===h.source?(o(),c(u,{key:0},[l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Type")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(e.info),1)])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("ID")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(e.id),1)])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Amount")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(v.formatAmount(e.amount)),1),l(R,{class:"currency"},{default:s((()=>[i("USDT")])),_:1})])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Time")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(v.formatTime(e.addtime)),1)])),_:2},1024)])),_:2},1024)],64)):(o(),c(u,{key:1},[l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Order Type")])),_:1}),l(S,{class:"tag-container"},{default:s((()=>[l(R,{class:"tag"},{default:s((()=>[i(d(v.getOrderTypeTag(e.type)),1)])),_:2},1024),l(R,{class:"product-name"},{default:s((()=>[i(d(e.title),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Escrow amount")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(v.formatAmount(e.amount)),1),l(R,{class:"currency"},{default:s((()=>[i("USDT")])),_:1})])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Profit")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(v.formatPercentage(e.bilv)),1),l(R,{class:"currency"},{default:s((()=>[i("%")])),_:1})])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Order time")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(v.formatTime(e.addtime)),1)])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Expire date")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(v.formatTime(e.endtime)),1)])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Order ID")])),_:1}),l(R,{class:"value"},{default:s((()=>[i(d(e.order_id),1)])),_:2},1024)])),_:2},1024),l(S,{class:"order-row"},{default:s((()=>[l(R,{class:"label"},{default:s((()=>[i("Order Status")])),_:1}),l(R,{class:m(["status-value",v.getStatusClass(e.status)])},{default:s((()=>[i(d(v.getStatusText(e.status)),1)])),_:2},1032,["class"])])),_:2},1024),l(S,{class:"social-icons"},{default:s((()=>[l(S,{class:"social-icon facebook"},{default:s((()=>[l(L,{class:"icon-image",src:y,mode:"aspectFit"})])),_:1}),l(S,{class:"social-icon twitter"},{default:s((()=>[l(L,{class:"icon-image",src:w,mode:"aspectFit"})])),_:1}),l(S,{class:"social-icon telegram"},{default:s((()=>[l(L,{class:"icon-image",src:T,mode:"aspectFit"})])),_:1}),l(S,{class:"social-icon youtube"},{default:s((()=>[l(L,{class:"icon-image",src:k,mode:"aspectFit"})])),_:1}),l(S,{class:"social-icon whatsapp"},{default:s((()=>[l(L,{class:"icon-image",src:b,mode:"aspectFit"})])),_:1})])),_:1})],64))])),_:2},1024)))),128))])),_:1}))])),_:1})}],["__scopeId","data-v-166b82ef"]]);export{R as default};
